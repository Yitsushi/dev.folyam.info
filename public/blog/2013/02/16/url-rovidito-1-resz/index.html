
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="hu"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>URL rövidítő 1. rész - [Dev] Folyam.info</title>
  <meta name="author" content="Balazs Nadasdi">

  
  <meta name="description" content="Most készíteni fogunk egy URL rövidítő oldalt. Az első részben csak offline lesz és semmit
sem fog elmenteni sehova. A második részben alá pakolunk &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta itemprop="name" content="URL rövidítő 1. rész - [Dev] Folyam.info">
  <meta property="og:title" content="URL rövidítő 1. rész - [Dev] Folyam.info">
  <meta itemprop="description" content="Most készíteni fogunk egy URL rövidítő oldalt. Az első részben csak offline lesz és semmit
sem fog elmenteni sehova. A második részben alá pakolunk &hellip;">
  <meta property="og:description" content="Most készíteni fogunk egy URL rövidítő oldalt. Az első részben csak offline lesz és semmit
sem fog elmenteni sehova. A második részben alá pakolunk &hellip;">
  <meta itemprop="image" content="http://dev.folyam.info.s3.amazonaws.com/2013-02-16-url-rovidito-1-resz/AngularJS-hogyan.png">
  <meta property="og:image" content="http://dev.folyam.info.s3.amazonaws.com/2013-02-16-url-rovidito-1-resz/AngularJS-hogyan.png">
  

  
  <link rel="canonical" href="http://dev.folyam.info/blog/2013/02/16/url-rovidito-1-resz/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/libs/jquery-1.9.1.min.js"></script>
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <meta property="og:url" content="http://dev.folyam.info/blog/2013/02/16/url-rovidito-1-resz/">
  <meta property="og:site_name" content="[Dev] Folyam.info">
  <meta property="og:type" content="blog">
  <link href="http://feeds.feedburner.com/devFolyaminfo" rel="alternate" title="[Dev] Folyam.info" type="application/atom+xml">
  
  <link href="https://plus.google.com/105613682641367710983" rel="publisher" />

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-33446239-4']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">[Dev] Folyam.info</a></h1>
  
    <h2>Elsősorban a programozói oldalam magyarul.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="http://feeds.feedburner.com/devFolyaminfo" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="http://feedburner.google.com/fb/a/mailverify?uri=devFolyaminfo&loc=hu_HU" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="http://www.google.hu" id="cse-search-box">
  <fieldset role="search">
    <input type="hidden" name="cx" value="partner-pub-4870755332408030:7956725702" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" class='search' name="q" placeholder="Keresés" style="background-image: none !important;" />
    <!-- <input type="submit" name="sa" value="Search" /> -->
  </fieldset>
</form>

<script type="text/javascript" src="http://www.google.hu/coop/cse/brand?form=cse-search-box&amp;lang=hu"></script>
<!--
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dev.folyam.info" />
    <input class="search" type="text" name="q" results="0" placeholder="Keresés"/>
  </fieldset>
</form>
-->
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archívum</a></li>
  <li><a href="/blog/categories">Kategóriák</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">URL Rövidítő 1. Rész</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-16T12:09:00+01:00" pubdate data-updated="true">Feb 16<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><img class="left" src="http://dev.folyam.info.s3.amazonaws.com/2013-02-16-url-rovidito-1-resz/AngularJS-hogyan.png" title="&#34;AngularJS Hogyan&#34;" alt="&#34;AngularJS Hogyan&#34;"></p>

<p>Most készíteni fogunk egy URL rövidítő oldalt. Az első részben csak offline lesz és semmit
sem fog elmenteni sehova. A második részben alá pakolunk egy szerveroldali réteget, hogy
amit berakunk URL-eket, azokat mentse is el valahova.</p>

<p>Kezdjük a legelején. Mit fogunk használni? <a href="http://angularjs.org/">AngularJS</a>
fogja kezelni a kliensoldali részt. Ez fog ügyelni arra, hogy minden adat a helyén legyen.
Először ezt állítjuk hadrendbe. Persze jó volna egyből alá rakni egy
<a href="http://nodejs.org/">Node.js</a> keretet, hogy később ne kelljen túlzottan mozgatni a
dolgokat, de ezt mi most nem tesszük meg. Most csak a kliensoldali résszel foglalkozunk.
Amúgy sem kell sokat mozgatni és átírni hozzá.</p>

<!--more-->


<p>A következő felvonásban alá rakjuk a már emlegetett Node.js-t és adatbázisként
<a href="http://www.mongodb.org/">MongoDB</a>-t fogunk használni. Természetesen mással is használható,
de jelenleg én ehhez csinálom a cikket és ezt használom. Minden későbbi fejezet attól függ,
hogy mi az igény és/vagy még mire lesz kedvem.</p>

<h3>HTML struktúra</h3>

<p>Mivel ez egy rém egyszerű dolog lesz, mármint a végcél, így sok dolgunk nincs a layout
munkálataival.</p>

<figure class='code'><figcaption><span>Layout (index.html)</span> <a href='/downloads/code/2013-02-16-url-rovidito-1-resz/index.html'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;html</span> <span class="na">ng-app</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;head&gt;</span>
</span><span class='line'>    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href=</span><span class="s">&quot;stylesheets/main.css&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;javascripts/angular.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;javascripts/app.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;body&gt;</span>
</span><span class='line'>    <span class="nt">&lt;div</span> <span class="na">ng-controller=</span><span class="s">&#39;App.controllers.Link&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;form</span> <span class="na">ng-submit=</span><span class="s">&quot;addLink()&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span>
</span><span class='line'>               <span class="na">ng-model=</span><span class="s">&quot;newLink&quot;</span>
</span><span class='line'>               <span class="na">placeholder=</span><span class="s">&quot;add new link here&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;add&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/form&gt;</span>
</span><span class='line'>
</span><span class='line'>      <span class="nt">&lt;table&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>          <span class="nt">&lt;th&gt;</span>Short link<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>          <span class="nt">&lt;th&gt;</span>Target link<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>          <span class="nt">&lt;th&gt;</span>Clicks<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>          <span class="nt">&lt;th&gt;</span>Created at<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>        <span class="nt">&lt;tr</span> <span class="na">ng-repeat=</span><span class="s">&quot;link in links&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;{{link.short}}&quot;</span><span class="nt">&gt;</span>{{link.short}}<span class="nt">&lt;/a&gt;&lt;/td&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;{{link.long}}&quot;</span><span class="nt">&gt;</span>{{link.long}}<span class="nt">&lt;/a&gt;&lt;/td&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;</span>{{link.clicks}}<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>          <span class="nt">&lt;td&gt;</span>{{link.created_at}}<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/table&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Mi mit jelent ebben? Első ami szembetűnik, hogy a <code>html</code> kapott egy <code>ng-app</code>
tulajdonságot. Ez megmondja, majd szépen az AngularJS-nek, hogy ez egy olyan alkalmazás,
amit neki kezelnie kell. Itt értéknek megadható egy <code>Project</code> a tulajdonság értékeként,
de ez nekünk most nem fontos.</p>

<p>Ezek után a szokásos <code>head</code> rész, amiben betöltjük a css fájlunkat, ami majd a stílust
határozza meg, az <code>angular.min.js</code>, ami önmaga az AngularJS és az <code>app.js</code> fájt, ami
tartalmazza, hogy mit csinál az oldal. A mi saját kódunk.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">ng-controller=</span><span class="s">&#39;App.controllers.Link&#39;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="c">&lt;!-- egyéb kód --&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Az AngularJS alapvetően ebből tudja, hogy az adott elem meglétével, kelleni fog neki egy
kontroller. Jelen esetben a <code>Link</code> kontroller. Az <code>App.controllers</code> nem AngularJS
specifikus, hanem én így különítem el a kód bizonyos részeit, ami most ugye a kontroller.</p>

<p>A kontroller fog cselekedni. Ez mondja meg, hogy mit kell csinálni. Itt adhatunk meg
társításokat (<code>data bind</code>), amikkel adott mező értékét össze tudjuk kötni változókkal,
vagy épp függvényekkel. Azok a függvények lesznek eléthetőek <em>(mondjuk)</em> a <code>view</code> számára,
amiket itt megmondunk, hogy elérhet.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;form</span> <span class="na">ng-submit=</span><span class="s">&quot;addLink()&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span>
</span><span class='line'>         <span class="na">ng-model=</span><span class="s">&quot;newLink&quot;</span>
</span><span class='line'>         <span class="na">placeholder=</span><span class="s">&quot;add new link here&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;add&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;/form&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<div class='ad-left'>
  <script type="text/javascript"><!--
    google_ad_client = "ca-pub-4870755332408030";
    /* DevFolyamArticle */
    google_ad_slot = "1829466906";
    google_ad_width = 300;
    google_ad_height = 250;
  //-->
  </script>
  <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</div>


<p>Ezek után találkozunk egy űrlappal, amiben egy sima <code>text</code> típusú mező és egy <code>submit</code>
gomb található. A <code>form</code> rendelkezik egy <code>ng-submit</code> tulajdonsággal, aminek az értéke
<code>addLink()</code>. Ez tulajdonképpen egyenlő az <code>onSubmit</code> eseményre való hivatkozással, csak
épp itt a szokásos <code>ng-</code> prefixet kapta meg. Az <code>addLink</code> nevű függvény fog lefutni.
A zárójelek azért kellenek, mert változót is átadhatunk neki paraméterben.</p>

<p>A beviteli mezőnk pedig egy <code>ng-model</code> tulajdonsággal lett felruházva, aminek hatására,
ha változik a mező értéke, akkor azt megkapja egy <code>newLink</code> nevű változó is a
kontrollerben megadottak szerint <em>(hamarosan)</em>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;tr</span> <span class="na">ng-repeat=</span><span class="s">&quot;link in links&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;{{link.short}}&quot;</span><span class="nt">&gt;</span>{{link.short}}<span class="nt">&lt;/a&gt;&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;{{link.long}}&quot;</span><span class="nt">&gt;</span>{{link.long}}<span class="nt">&lt;/a&gt;&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;</span>{{link.clicks}}<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;td&gt;</span>{{link.created_at}}<span class="nt">&lt;/td&gt;</span>
</span><span class='line'><span class="nt">&lt;/tr&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ezek után egy sima táblázatot látunk, ami talán abban tér el a megszokottól, hogy a fejléc
után a <code>tr</code> kapott egy <code>ng-repeat</code>-et. Ez amolyan <code>forEach</code> azzal a különbséggel, hogy nem
a benne találhatóakat ismétli, hanem önmagát az elemet is. Tehát jelen esetben a
<em>(kontrollerben meghatározott)</em> <code>links</code> tömb minden elemén végighaladunk és minden elemre
a cikluson belül <code>link</code> néven akarunk hivatkozni.</p>

<p>Ezek után – hasonlóan a <a href="http://twig.sensiolabs.org/">Twig</a> <em>(PHP)</em> template rendszerhez –
két kapcsoszárójelbe rakva pakolunk ki tartalmat a böngészőbe.</p>

<h3>JavaScript: AngularJS</h3>

<p>Most jön a lényegi rész. Eddig csak firkáltunk, a lapunk nem csinált semmit és még hülyén
is nézett ki. Varázsoljunk rá mozgást.</p>

<figure class='code'><figcaption><span>AngularJS alkalmazásunk (app.js)</span> <a href='/downloads/code/2013-02-16-url-rovidito-1-resz/javascripts/app.js'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">controllers</span><span class="o">:</span> <span class="p">{},</span>
</span><span class='line'>  <span class="nx">configuration</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">domain</span><span class="o">:</span> <span class="s2">&quot;s.l&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">protocol</span><span class="o">:</span> <span class="s2">&quot;http&quot;</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">utils</span><span class="o">:</span> <span class="p">{}</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="nx">UrlUtils</span> <span class="p">(</span><span class="nx">app</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">app</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">app</span><span class="p">.</span><span class="nx">configuration</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">+</span> <span class="s2">&quot;://&quot;</span> <span class="o">+</span> <span class="nx">app</span><span class="p">.</span><span class="nx">configuration</span><span class="p">.</span><span class="nx">domain</span> <span class="o">+</span> <span class="nx">path</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">})(</span><span class="nx">App</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="nx">LinkController</span> <span class="p">(</span><span class="nx">app</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">app</span><span class="p">.</span><span class="nx">controllers</span><span class="p">.</span><span class="nx">Link</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">links</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">addLink</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">addLink</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">$scope</span><span class="p">.</span><span class="nx">links</span><span class="p">.</span><span class="nx">unshift</span><span class="p">({</span>
</span><span class='line'>        <span class="kr">short</span><span class="o">:</span> <span class="nx">App</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;/a4d56g&quot;</span><span class="p">),</span>
</span><span class='line'>        <span class="kr">long</span><span class="o">:</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">newLink</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">clicks</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">created_at</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">$scope</span><span class="p">.</span><span class="nx">newLink</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="nx">app</span><span class="p">.</span><span class="nx">controllers</span><span class="p">.</span><span class="nx">Link</span><span class="p">.</span><span class="nx">$inject</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$scope&#39;</span><span class="p">];</span>
</span><span class='line'><span class="p">})(</span><span class="nx">App</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>




<div class='ad-right'>
  <script type="text/javascript"><!--
    google_ad_client = "ca-pub-4870755332408030";
    /* DevFolyamArticle */
    google_ad_slot = "1829466906";
    google_ad_width = 300;
    google_ad_height = 250;
  //-->
  </script>
  <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</div>


<p>Akkor most bontsuk szét. Először is találunk egy <code>App</code> objektumot, amibe pakoltunk egy
üres <code>controllers</code> objektumot. Ez lesz majd a kontrollerek helye. Ismétlem nem kell így
csinálni, de én így látom át igazán. Mindennek meg kell lennie a helyének :) Továbbá
található benne egy <code>utils</code> és egy <code>configuration</code> objektum. Előbbibe pakoljuk majd azokat
a kódjainkat, amik segítenek nekünk, mint például az URL generáló.
Utóbbiban pedig az URL képzéséhez használt adatok vannak, mint például a domain és a protocol.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">(</span><span class="kd">function</span> <span class="nx">UrlUtils</span> <span class="p">(</span><span class="nx">app</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">app</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">app</span><span class="p">.</span><span class="nx">configuration</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">+</span> <span class="s2">&quot;://&quot;</span> <span class="o">+</span> <span class="nx">app</span><span class="p">.</span><span class="nx">configuration</span><span class="p">.</span><span class="nx">domain</span> <span class="o">+</span> <span class="nx">path</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">})(</span><span class="nx">App</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ez egy rém egyszerű függvény, ami kap egy <code>path</code> értéket, és elédobja az URL statikus
részét. Nagyjából mindent be szoktam zárni egy függvénybe, hogy csak ahhoz férjen hozzá,
amihez én akarom és belőle is csak az látszódjon, amit én akarok, hogy lássanak belőle.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">controllers</span><span class="p">.</span><span class="nx">Link</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// egyéb kód</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">controllers</span><span class="p">.</span><span class="nx">Link</span><span class="p">.</span><span class="nx">$inject</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$scope&#39;</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>Itt két dolgot csinálunk, mégis egyet. Először is létrehozunk egy kontrollert, ami a már
jól ismert <code>App.controllers.Link</code> címen lesz elérhető. Egyetlen paramétere a <code>$scope</code>, mert
most még mást nem használunk. Ami a <code>$scope</code> alá bekerül <em>(tulajdonsága)</em>, az fog látszódni
a <code>view</code>-ban is. Tehát itt fogjuk majd létrehozni a <code>links</code> tömböt és az <code>addLink</code> függvényt.
Az utána lévő sor megadja, hogy mik a paraméterei a kontrollerünknek, mert ha tömörítjük a
végén a JavaScript kódot, akkor nem fogja tudni az AngularJS, hogy mi a neve a változónak.
Érdekes elgondolás, hogy a változó neve alapján adja meg a paraméter értékét és nem a
paraméterek sorrendje számít, de így nagyon kényelmes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$scope</span><span class="p">.</span><span class="nx">links</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'><span class="nx">$scope</span><span class="p">.</span><span class="nx">addLink</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">addLink</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">$scope</span><span class="p">.</span><span class="nx">links</span><span class="p">.</span><span class="nx">unshift</span><span class="p">({</span>
</span><span class='line'>    <span class="kr">short</span><span class="o">:</span> <span class="nx">App</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;/a4d56g&quot;</span><span class="p">),</span>
</span><span class='line'>    <span class="kr">long</span><span class="o">:</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">newLink</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">clicks</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">created_at</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$scope</span><span class="p">.</span><span class="nx">newLink</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Legyen akkor a <code>$scope</code> alatt egy <code>links</code> tömb, ami alapértelmezetten üres. A következő
részben majd letöltjük a szerverről induláskor a már meglévőket. Ezek után létrehozzuk az
<code>addLink</code> függvényt, ami ugyebát az űrlapunk <code>onSubmit</code> eseményére hívódik meg. Az egész
egy egyszerű tömbművelettel indul, minthogy egy objektumot betolunk a <code>links</code> tömbünk
elejére. A tömb tulajdonságai ugyebár a <code>short</code>, amit az <code>App.utils.url.get</code> függvénye
ad vissza, a <code>long</code> az a megadott linkünk. A <code>clicks</code> jelenleg teljesen mindegy, simán
nullára állítjuk. A <code>created_at</code> mező meg csak azért van, hogy tudjuk mikor lett
létrehozva így felveszi az aktuális időt értéknek. Ezek után kitöröljük a <code>newLink</code>
értékét.</p>

<div class='ad-right'>
  <script type="text/javascript"><!--
    google_ad_client = "ca-pub-4870755332408030";
    /* DevFolyamArticle */
    google_ad_slot = "1829466906";
    google_ad_width = 300;
    google_ad_height = 250;
  //-->
  </script>
  <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</div>


<p>Mivel a tömbünk össze lett kapcsolva az <code>ng-repeat</code> használata során a táblázattal, így
ha változik a tömb, akkor frissíti a táblázat sorait.</p>

<p>Nem túl érdekes a link generálása, mert most statikusan minden URL végére ugyan azt
fogja tenni. Amiért nem törtem magam rajta, az azért van, mert ez úgyis a szerver oldalon
fog generálódni.</p>

<p>Van benne egy hivatkozás, ami furcsa lehet – még a többihez képest is – mégpedig önmaga
a <code>newLink</code>. Ugye már mondtam, hogy a kontrollerben megadott változókhoz fér hozzá a <code>view</code>.
Viszont, ha <code>ng-model</code> segítségével megadok egy változót, ám az nem létezik, akkor
létrehozza nekünk a <code>$scope</code> alatt.</p>

<h3>Meddig jutottunk?</h3>

<p>Egyelőre egy teljesen használhatatlan offline alkalmazást csináltunk, amibe be tudunk
írni bármit és ahhoz ő csinál egy &#8220;rövid&#8221; címet. Az eddig elkészült rész
<a href="/downloads/code/2013-02-16-url-rovidito-1-resz/index.html">megtekinthető itt</a>.</p>
</div>


  <footer>
    <p class="meta">
      
  



  



  <span class="byline author vcard">Beküldő: <a href="https://plus.google.com/104695723888883478740?rel=author" target="_blank"><span class="fn">Balazs Nadasdi</span></a></span>


      








  


<time datetime="2013-02-16T12:09:00+01:00" pubdate data-updated="true">Feb 16<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/angularjs/'>angularjs</a>, <a class='category' href='/blog/categories/hogyan/'>hogyan</a>, <a class='category' href='/blog/categories/html/'>html</a>, <a class='category' href='/blog/categories/javascript/'>javascript</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://dev.folyam.info/blog/2013/02/16/url-rovidito-1-resz/" data-via="yitsushi" data-counturl="http://dev.folyam.info/blog/2013/02/16/url-rovidito-1-resz/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/02/15/css-ben-target/" title="Previous Post: CSS-ben :target?">&laquo; CSS-ben :target?</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/02/17/weboldal-google-drive-bol/" title="Next Post: Weboldal Google Drive-ból">Weboldal Google Drive-ból &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Legutóbbi bejegyzések</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/02/18/par-hasznos-konyv-node-dot-js/">Pár hasznos könyv (1. felvonás)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/17/weboldal-google-drive-bol/">Weboldal Google Drive-ból</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/16/url-rovidito-1-resz/">URL rövidítő 1. rész</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/15/css-ben-target/">CSS-ben :target?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/15/roviden-tomoren/">Röviden tömören</a>
      </li>
    
  </ul>
</section>

<section class="googleplus">
  <div class="g-plus" data-width="260" data-href="https://plus.google.com/105613682641367710983" data-rel="publisher"></div>
</section>
<section>
  <h1>Kategóriák</h1>
  <ul id="category-list"><li><a href='/blog/categories/angularjs'>angularjs (1)</a></li><li><a href='/blog/categories/book'>book (1)</a></li><li><a href='/blog/categories/css'>css (1)</a></li><li><a href='/blog/categories/general'>general (1)</a></li><li><a href='/blog/categories/google'>google (1)</a></li><li><a href='/blog/categories/hogyan'>hogyan (2)</a></li><li><a href='/blog/categories/html'>html (2)</a></li><li><a href='/blog/categories/javascript'>javascript (1)</a></li><li><a href='/blog/categories/recommended'>recommended (1)</a></li><li><a href='/blog/categories/ticks'>ticks (1)</a></li></ul>
</section>
<section>
  <h1>Csiripelések</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("yitsushi", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/yitsushi" class="twitter-follow-button" data-show-count="false">Follow @yitsushi</a>
  
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/yitsushi">@yitsushi</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'yitsushi',
            count: 5,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Balazs Nadasdi -
  <span class="credit">Powered by <a href="http://octopress.org" target="_blank">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'devfolyaminfo';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://dev.folyam.info/blog/2013/02/16/url-rovidito-1-resz/';
        var disqus_url = 'http://dev.folyam.info/blog/2013/02/16/url-rovidito-1-resz/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    window.___gcfg = {lang: 'hu'};

    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



<script type="text/javascript">
  jQuery(function() {
    jQuery('a[href^="http://"], a[href^="https://"], a[href^="/downloads"]').attr('target', '_blank');
  });
</script>

</body>
</html>
